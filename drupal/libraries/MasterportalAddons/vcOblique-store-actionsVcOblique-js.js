(window.webpackJsonp=window.webpackJsonp||[]).push([[525],{3516:function(_,U,p){(function(f){var V=Object.create,v=Object.defineProperty,I=Object.getOwnPropertyDescriptor,C=Object.getOwnPropertyNames,k=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty,S=(o,n)=>{for(var e in n)v(o,e,{get:n[e],enumerable:!0})},M=(o,n,e,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of C(n))!q.call(o,t)&&t!==e&&v(o,t,{get:()=>n[t],enumerable:!(r=I(n,t))||r.enumerable});return o},P=(o,n,e)=>(e=o!=null?V(k(o)):{},M(n||!o||!o.__esModule?v(e,"default",{value:o,enumerable:!0}):e,o)),E=o=>M(v({},"__esModule",{value:!0}),o),h=(o,n,e)=>new Promise((r,t)=>{var a=i=>{try{u(e.next(i))}catch(c){t(c)}},l=i=>{try{u(e.throw(i))}catch(c){t(c)}},u=i=>i.done?r(i.value):Promise.resolve(i.value).then(a,l);u((e=e.apply(o,n)).next())}),O={};S(O,{default:()=>L}),_.exports=E(O);var w=P(p(54)),R=P(p(64)),L={initObliqueView({commit:o,dispatch:n,getters:e,rootGetters:r}){const t=document.getElementById("obliqueIframe");t?.addEventListener("load",()=>{const a=new MutationObserver(()=>{const l=t.contentWindow.document.getElementById("header"),u=t.contentWindow.document.getElementsByClassName("vcm-btn-icon single-first maptool-btn vcm-btn-base-default vcm-btn-base-splash-hover vcm-border vcm-border-dye03 vcm-btn-icon-font-default vcm-btn-icon-font-dye01-hover vcm-no-select vcm-btn-map-Oblique")[0],i=t.contentWindow.document.getElementsByClassName("overview-map-wrap")[0],c=document.getElementById("obliqueIframe").contentWindow.vcs,s=c.vcm.Framework.getInstance().getActiveMap(),m=mapCollection.getMap("2D").getPixelFromCoordinate(r["Maps/initialCenter"]),g=t.contentWindow.document.getElementsByClassName("mapElement vcm-map-top");if(o("Maps/setClickCartesianCoordinate",m,{root:!0}),s&&(s.olMap.on("moveend",()=>{const d=w.default.transform("EPSG:4326",mapCollection.getMapView("2D").getProjection().getCode(),s.getViewPointSync().groundPosition);d.every((y,b)=>Math.round(y)!==Math.round(e.lastCoordinates[b])&&(y-e.lastCoordinates[b]>50||y-e.lastCoordinates[b]<-50)?(n("setObliqueView",d),!1):!0)}),s.imageChanged.addEventListener(()=>h(this,null,function*(){const d=yield s.getViewPoint();d.heading!==e.heading&&n("MapMarker/rotatePointMarker",d.heading,{root:!0}),o("setHeading",d.heading)}))),l){l.style.display="none",l.parentElement.style.display="none";for(const d of g)d.style.top=0;o("setDefaultMapMarkerStyleId",r["MapMarker/pointStyleId"]),e.styleId&&o("MapMarker/setPointStyleId",e.styleId,{root:!0}),n("setObliqueView",r["Maps/center"]),a.disconnect()}u&&(u.style.display="none"),i&&(i.style.display="none")});a.observe(t.contentDocument,{childList:!0,subtree:!0})})},resetObliqueViewer({commit:o,dispatch:n,getters:e}){o("MapMarker/setPointStyleId",e.defaultMapMarkerStyleId,{root:!0}),n("MapMarker/removePointMarker",null,{root:!0})},setObliqueView(o){return h(this,arguments,function*({commit:n,dispatch:e,getters:r},t=[]){var a,l,u,i,c;const s=(l=(a=document.getElementById("obliqueIframe"))==null?void 0:a.contentWindow)==null?void 0:l.vcs,m=(i=(u=s?.vcm)==null?void 0:u.Framework)==null?void 0:i.getInstance(),g=m?.getActiveMap();let d={};m&&t&&Array.isArray(t)&&t.length>1?(n("setLastCoordinates",t),(c=s?.vcm)!=null&&c.util&&(d=new s.vcm.util.ViewPoint({groundPosition:w.default.transform(mapCollection.getMapView("2D").getProjection().getCode(),"EPSG:4326",t),heading:r.heading,distance:g.getViewPointSync().distance})),yield m?.getActiveMap().gotoViewPoint(d),e("MapMarker/placingPointMarker",t,{root:!0}),e("MapMarker/rotatePointMarker",r.heading,{root:!0})):e("Alerting/addSingleAlert","<strong>"+f.t("additional:modules.tools.vcOblique.frameworkUndefined")+"</strong><br><small>"+f.t("additional:modules.tools.vcOblique.frameworkUndefinedMessage")+"</small>",{root:!0})})},setObliqueViewerURL({commit:o,dispatch:n,getters:e,rootGetters:r},t){if(t&&Array.isArray(t)&&t.length>1){const a=w.default.transform(mapCollection.getMapView("2D").getProjection().getCode(),"EPSG:4326",t),l=a[0]+", "+a[1];document.location.hostname==="localhost"?o("setObliqueViewerURL",(0,R.default)(r.getRestServiceById(e.serviceId).url)+"?groundPosition="+l):n("setObliqueViewerURLWithSameHostname",l)}},setObliqueViewerURLWithSameHostname({commit:o,dispatch:n,getters:e,rootGetters:r},t){const a=r.getRestServiceById(e.serviceId).url.split("https://")[1].split("/");document.location.hostname===a[0]?o("setObliqueViewerURL",r.getRestServiceById(e.serviceId).url+"?groundPosition="+t):document.location.hostname.startsWith("www.")&&document.location.hostname.split("www.")[1]===a[0]?n("setObliqueViewerURLWithReplacedHostname",{urlParts:a,startCoordinates:t}):n("Alerting/addSingleAlert",f.t("additional:modules.tools.vcOblique.sameOrigin"),{root:!0})},setObliqueViewerURLWithReplacedHostname({commit:o},{urlParts:n,startCoordinates:e}){let r="https:/";n.forEach((t,a)=>{a===0?r=r+"/"+document.location.hostname:r=r+"/"+t}),o("setObliqueViewerURL",r+"?groundPosition="+e)}}}).call(this,p(5))}}]);
